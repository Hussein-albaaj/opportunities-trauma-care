---
title: "Factors associated with opportunities for improvement in trauma care: A registry-based study"
output: bookdown::pdf_document2
bibliography: citation.bib
always_allow_html: true
csl: bmcemerg.csl
link-citations: yes
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```
```{r global_options, include=FALSE}
knitr::opts_chunk$set(fig.pos = 'H')
```
```{r, include=FALSE}
options(tinytex.verbose = TRUE)
```
\newpage

```{r library, include=FALSE}
library(readr)
library(naniar)
library(plyr)
library(dplyr)
library("questionr")
library(table1)
library(ggplot2)
library(gridExtra)
library(gtsummary)
library(DiagrammeR)
library(PRISMAstatement)
library(knitr)
library(gt)
library(tidyverse)
library(glue)
library(tinytex)
library(rmarkdown)
library(RMariaDB)
library(DBI)
library(keyring)
library(dotenv)
library(gtsummary)
library(flextable)
library(kableExtra)
library(ggpubr)
library(lubridate)
library(parameters)
library(rofi)
```



```{r include=FALSE}
conn <- DBI::dbConnect(drv = RMariaDB::MariaDB(),
                       user = 'husseina',
                       password = Sys.getenv("DB_PASSWORD"),
                       db = "opportunities_for_improvement")


dataset.names <- setNames(nm = c("swetrau", "fmp", "atgarder", "problem"))
datasets <- lapply(dataset.names, function(dataset.name) dbReadTable(conn = conn, name = dataset.name))

attach(datasets)

swetrau$arrival <- as.POSIXct(strptime(swetrau$DateTime_ArrivalAtHospital, format = "%Y-%m-%d %H:%M"))
fmp$arrival <- as.POSIXct(strptime(fmp$Ankomst_te, format = "%Y%m%d %H:%M"))
problem$arrival <- as.POSIXct(strptime(problem$Ankomst_te, format = "%Y%m%d %H:%M"))
swetrau$id <- paste(swetrau$arrival, swetrau$PersonIdentity, swetrau$TempIdentity)
fmp$id <- paste(fmp$arrival, fmp$Personnummer, fmp$Reservnummer)
problem$id <- paste(problem$arrival, problem$Personnummer, problem$Reservnummer)

# Combine datasets
combined.data <- merge(fmp, problem, by = "id", all.x = TRUE)
combined.data <- merge(combined.data, swetrau, by = "id", all.x = TRUE)

detach(datasets)
combined.datasets<-filter(combined.data, as.Date(strptime(combined.data$Ankomst_te.x, format = "%Y%m%d %H:%M")) >="2017-01-01")

combined.datasets$ofi <- create_ofi(combined.datasets)
combined.datasets$ofi <- with(combined.datasets, ifelse(is.na(ofi) | ofi == "No", "No", "Yes"))


# Gör en kolumn med intub: 1, intub ED, 2. Ej intub. 3. Intub prehosp.
combined.datasets$intub <- with(combined.datasets, ifelse(`pre_intubated` == 1 & is.na(combined.datasets$pre_intubated) == FALSE, 3, `ed_intubated`))
# Förklaring: tub<- om pre inte är Na och är 1(ja), sant: konvertera till 3, Falskt: använd ed_intubated (1 är ja och 2 är nej)

# Gör om 999 till Na
ab<-combined.datasets %>% replace_with_na(replace = list( "res_survival" = 999))
ac<-ab %>% replace_with_na(replace = list( "intub" = 999))
ada<-ac %>% replace_with_na(replace = list( "host_care_level" = 999))
adab<-ada %>% replace_with_na(replace = list( "ed_sbp_rtscat" = 999))
adac<-adab %>% replace_with_na(replace = list( "ed_rr_rtscat" = 999))
adad<-adac %>% replace_with_na(replace = list( "pre_rr_rtscat" = 999))
adae<-adad %>% replace_with_na(replace = list( "ed_sbp_value" = 999))
adah<-adae %>% replace_with_na(replace = list( "ed_rr_value" = 999))
adag<-adah %>% replace_with_na(replace = list( "pre_rr_value" = 999))
adaj<-adag %>% replace_with_na(replace = list( "ed_gcs_sum" = 999))
swee<-adaj %>% replace_with_na(replace = list( "pre_gcs_sum" = 999))

# Gör om blodtryck till RTS
swee$ed_sbp_value[is.na(swee$ed_sbp_value)]<-350

swee$ed_sbp_value[swee$ed_sbp_value>=1 & swee$ed_sbp_value<=49]<-1
swee$ed_sbp_value[swee$ed_sbp_value>=50 & swee$ed_sbp_value<=75]<-2
swee$ed_sbp_value[swee$ed_sbp_value>=76 & swee$ed_sbp_value<=89]<-3
swee$ed_sbp_value[swee$ed_sbp_value>89 & swee$ed_sbp_value<=298]<-4
swee$ed_sbp_value[swee$ed_sbp_value==350]<-5

# Tar RTS värdet från ed, om det inte finns så använder den vanliga blodtrycket, som är grupperat enligt RTS.
swee$sbp_rts<-with(swee, ifelse(is.na(swee$ed_sbp_rtscat)==FALSE,ed_sbp_rtscat,ed_sbp_value))

# Samma med ed_RR
swee$ed_rr_value[is.na(swee$ed_rr_value)]<-350

swee$ed_rr_value[swee$ed_rr_value>=1 & swee$ed_rr_value<=5]<-1
swee$ed_rr_value[swee$ed_rr_value>=6 & swee$ed_rr_value<=9]<-2
swee$ed_rr_value[swee$ed_rr_value>=10 & swee$ed_rr_value<=29]<-4
swee$ed_rr_value[swee$ed_rr_value>29 & swee$ed_rr_value<=70]<-3
swee$ed_rr_value[swee$ed_rr_value==99]<-5
swee$ed_rr_value[swee$ed_rr_value==350]<-5

swee$ed_rr_rts<-with(swee, ifelse(is.na(swee$ed_rr_rtscat)==FALSE,ed_rr_rtscat,ed_rr_value))

# Samma med pre_RR
swee$pre_rr_value[swee$pre_rr_value>=1 & swee$pre_rr_value<=5]<-1
swee$pre_rr_value[swee$pre_rr_value>=6 & swee$pre_rr_value<=9]<-2
swee$pre_rr_value[swee$pre_rr_value>=10 & swee$pre_rr_value<=29]<-4
swee$pre_rr_value[swee$pre_rr_value>29 & swee$pre_rr_value<=70]<-3
swee$pre_rr_value[swee$pre_rr_value==99]<-5
swee$pre_rr_value[swee$pre_rr_value==350]<-5

swee$pre_rr_rts<-with(swee, ifelse(is.na(swee$pre_rr_rtscat)==FALSE ,pre_rr_rtscat,pre_rr_value))

swee$rr_rts<-with(swee, ifelse(intub == 3 & pre_rr_rts !=5,pre_rr_rts,ed_rr_rts))

swee$ed_gcs_sum[is.na(swee$ed_gcs_sum)]<-350

# Konvertera GCS till mild 13-15 (3), moderate 9-12 (2), severe 3-8. (1). 5 = MISSING
swee$ed_gcs_sum[swee$ed_gcs_sum>=3 & swee$ed_gcs_sum<=8]<-1
swee$ed_gcs_sum[swee$ed_gcs_sum>=9 & swee$ed_gcs_sum<=12]<-2
swee$ed_gcs_sum[swee$ed_gcs_sum>=13 & swee$ed_gcs_sum<=15]<-3
swee$ed_gcs_sum[swee$ed_gcs_sum==99]<-5
swee$ed_gcs_sum[swee$ed_gcs_sum==350]<-5

# Gör samma med pre_GCS
swee$pre_gcs_sum[is.na(swee$pre_gcs_sum)]<-350

swee$pre_gcs_sum[swee$pre_gcs_sum>=3 & swee$pre_gcs_sum<=8]<-1
swee$pre_gcs_sum[swee$pre_gcs_sum>=9 & swee$pre_gcs_sum<=12]<-2
swee$pre_gcs_sum[swee$pre_gcs_sum>=13 & swee$pre_gcs_sum<=15]<-3
swee$pre_gcs_sum[swee$pre_gcs_sum==99]<-5
swee$pre_gcs_sum[swee$pre_gcs_sum==350]<-5

# Skapa gcs_sum som blir vår nya gcs, 5=missing
swee$gc<-with(swee, ifelse(intub == 3 & pre_gcs_sum !=5,pre_gcs_sum,ed_gcs_sum))
swee$gcs<-with(swee, ifelse(intub == 1 & gc ==5,99,gc))
swee$gcs_sum<-with(swee, ifelse(intub == 3 & gcs ==5,99,gcs))

# Egen datafram för räkna missing data
fake.var<-c("Gender","res_survival","intub","host_care_level","rr_rts","sbp_rts","gcs_sum")
rak.var<-c("id","ofi","Gender","res_survival","intub","host_care_level","rr_rts","sbp_rts","gcs_sum")
cont.var<-c("ISS","dt_ed_first_ct","pt_age_yrs")
cont.procedure.var<-c("ISS","dt_ed_first_ct","pt_age_yrs","dt_ed_emerg_proc")
cat.var<-c("ofi","Gender","res_survival","intub","host_care_level","rr_rts","sbp_rts","gcs_sum")

# Gör ny dataframe för att räkna missing data
ba<-select(swee,rak.var,cont.var)
kl<-select(swee,fake.var,cont.var)
na.kl<-na.omit(kl)

# Sätt ihop databaser
calc<-ba

# Gör om till Na
calh<-calc %>% replace_with_na(replace = list('pt_age_yrs'=11))
calj<-calh %>% replace_with_na(replace = list('pt_age_yrs'=13))
calk<-calj %>% replace_with_na(replace = list('pt_age_yrs'=14))

# Gör om missing i vitalparametrar för att beräkna missing
calb<-calk %>% replace_with_na(replace = list('rr_rts'=5))
cald<-calb %>% replace_with_na(replace = list('sbp_rts'=5))
cale<-cald %>% replace_with_na(replace = list('gcs_sum'=5))

sew<-as.data.frame(freq.na(cale))

# Välj variabler
nks<-select(calk,cat.var,cont.var)

# Ta bort alla missing data
ki<- na.omit(nks)

# Kopiera dataframe
ae<-ki
aa<-ki

# Gör om till faktorer
str(aa)
aa$ofi<-as.factor(aa$ofi)
aa$Gender<-as.factor(aa$Gender)
aa$host_care_level<-as.factor(aa$host_care_level)
aa$intub<-as.factor(aa$intub)
aa$res_survival<-as.factor(aa$res_survival)
aa$rr_rts<-as.factor(aa$rr_rts)
aa$sbp_rts<-as.factor(aa$sbp_rts)
aa$gcs_sum<-as.factor(aa$gcs_sum)
aa$ISS<-as.numeric(aa$ISS)
aa$dt_ed_first_ct<-as.numeric(aa$dt_ed_first_ct)
aa$pt_age_yrs<-as.numeric(aa$pt_age_yrs)

# Ritar ut alla värden på graf
pairs(aa,col=aa$ofi)

# Resultat för varje variabel, unadjusted

sex<-glm(ofi~Gender,data = aa,family = 'binomial')
summary(sex)

surv<-glm(ofi~res_survival,data = aa,family = 'binomial')
summary(surv)

tub<-glm(ofi~intub,data = aa,family = 'binomial')
summary(tub)

care<-glm(ofi~host_care_level,data = aa,family = 'binomial')
summary(care)

resp<-glm(ofi~rr_rts,data = aa,family = 'binomial')
summary(resp)

sysbp<-glm(ofi~sbp_rts,data = aa,family = 'binomial')
summary(sysbp)

gcs_var<-glm(ofi~gcs_sum,data = aa,family = 'binomial')
summary(gcs_var)

injury<-glm(ofi~ISS,data = aa,family = 'binomial')
summary(injury)

first_ct<-glm(ofi~dt_ed_first_ct,data = aa,family = 'binomial')
summary(first_ct)


age<-glm(ofi~pt_age_yrs,data = aa,family = 'binomial')
summary(age)


# Table 1
aa$ofi <-
  factor(aa$ofi,
         levels=c("No","Yes"),
         labels=c("No opportunity for improvement",
                  "Opportunity for improvement"))

aa$Gender <-
  factor(aa$Gender, levels=c("M","K"),
         labels=c("Male",
                  "Female"))

aa$res_survival <-
  factor(aa$res_survival, levels=c("2","1"),
         labels=c("Alive",
                  "Dead"))

aa$intub <-
  factor(aa$intub, levels=c("2","3","1"),
         labels=c("None","Pre-intub",
                  "ED-intub"))

aa$host_care_level <-
  factor(aa$host_care_level, levels=c("1","2","3","4","5"),
         labels=c("Emergency Department","General Ward","Surgical Ward","High Dependency Unit","Critical Care Unit"))

aa$sbp_rts <-
  factor(aa$sbp_rts, levels=c("4","3","2","1","0","5"),
         labels=c(">89","76-89","50-75","1-49","0","Missing"))

aa$gcs_sum <-
  factor(aa$gcs_sum, levels=c("3","2","1","5","99"),
         labels=c("13-15","9-12","3-8","Missing","Pre-intub"))

aa$rr_rts <-
  factor(aa$rr_rts, levels=c("4","3","2","1","0","5"),
         labels=c("10-29",">29","6-9","1-5","0","Missing"))

label(aa$ofi)      <- "Outcome"
label(aa$ISS)      <- "Injury Severity Score"
label(aa$Gender)       <- "Sex"
label(aa$intub)     <- "Intubation"
label(aa$pt_age_yrs)       <- "Age"
label(aa$res_survival)       <- "Survival after 30 days"
label(aa$host_care_level)       <- "Highest hospital care level"
label(aa$intub)       <- "Intubation"
label(aa$rr_rts)       <- "Respiratory rate"
label(aa$sbp_rts)       <- "Systolic Blood Pressure"
label(aa$gcs_sum)       <- "GCS"
label(aa$dt_ed_first_ct)       <- "Time to first CT"

units(aa$pt_age_yrs)       <- "Years"
units(aa$dt_ed_first_ct)   <- "minutes"
units(aa$sbp_rts)       <- "RTS"
units(aa$rr_rts)       <- "RTS"
units(aa$gcs_sum)       <- "RTS"

# Resultat för adjusted variabels
outcome_log<-glm(ofi~.,data = aa,family = 'binomial')
summary(outcome_log)

opo<- as.data.frame(table1(~ Gender + pt_age_yrs + res_survival + host_care_level + intub + ISS + rr_rts + sbp_rts +
         gcs_sum + dt_ed_first_ct | ofi, data=aa))

# Kod för resultat-delen
# Värden för stapel-diagram
calculation<-aa
calculation$host_care_level <-
  factor(calculation$host_care_level, levels=c("Emergency Department","General Ward","Surgical Ward","High Dependency Unit","Critical Care Unit"),
         labels=c("Emergency Department","General Ward","Surgical Ward","High Dependency Unit","Critical Care Unit"))

calculation$intub <-
  factor(calculation$intub, levels=c("Pre-intub","ED-Intub","None"),
         labels=c("Pre-Intub", "Intub","Not Intub"))

calculation$gcs_sum <-
  factor(calculation$gcs_sum, levels=c("Mild: 13-15","Moderate: 9-12","Severe: 3-8","Missing","Pre-intubated"),
         labels=c("13-15","9-12","3-8","Missing","Pre-intub"))

```

```{r include=FALSE, warning=FALSE}
app.ba<-select(swee,rak.var,cont.procedure.var)
app.kl<-select(swee,fake.var,cont.procedure.var)
app.calc<-app.ba

app.calh<-app.calc %>% replace_with_na(replace = list('pt_age_yrs'=11))
app.calj<-app.calh %>% replace_with_na(replace = list('pt_age_yrs'=13))
app.calk<-app.calj %>% replace_with_na(replace = list('pt_age_yrs'=14))

# Gör om missing i vitalparametrar för att beräkna missing
app.calb<-app.calk %>% replace_with_na(replace = list('rr_rts'=5))
app.cald<-app.calb %>% replace_with_na(replace = list('sbp_rts'=5))
app.cale<-app.cald %>% replace_with_na(replace = list('gcs_sum'=5))

app.sew<-as.data.frame(freq.na(app.cale))

app.nks<-select(app.calk,cat.var,cont.procedure.var)

app.ki<- na.omit(app.nks)
app.ae<-app.ki
app.aa<-app.ki

app.aa$ofi<-as.factor(app.aa$ofi)
app.aa$Gender<-as.factor(app.aa$Gender)
app.aa$host_care_level<-as.factor(app.aa$host_care_level)
app.aa$intub<-as.factor(app.aa$intub)
app.aa$res_survival<-as.factor(app.aa$res_survival)
app.aa$rr_rts<-as.factor(app.aa$rr_rts)
app.aa$sbp_rts<-as.factor(app.aa$sbp_rts)
app.aa$gcs_sum<-as.factor(app.aa$gcs_sum)
app.aa$ISS<-as.numeric(app.aa$ISS)
app.aa$dt_ed_first_ct<-as.numeric(app.aa$dt_ed_first_ct)
app.aa$dt_ed_emerg_proc<-as.numeric(app.aa$dt_ed_emerg_proc)
app.aa$pt_age_yrs<-as.numeric(app.aa$pt_age_yrs)
str(app.aa)

app.aa$ofi <-
  factor(app.aa$ofi,
         levels=c("No","Yes"),
         labels=c("No opportunity for improvement",
                  "Opportunity for improvement"))

app.aa$Gender <-
  factor(app.aa$Gender, levels=c("M","K"),
         labels=c("Male",
                  "Female"))

app.aa$res_survival <-
  factor(app.aa$res_survival, levels=c("1","2"),
         labels=c("Dead",
                  "Alive"))

app.aa$intub <-
  factor(app.aa$intub, levels=c("3","1","2"),
         labels=c("Pre-hospital Intubation",
                  "ED Intubation","Not Intubated"))

app.aa$host_care_level <-
  factor(app.aa$host_care_level, levels=c("1","2","3","4","5"),
         labels=c("Emergency Department","General Ward","Surgical Ward","High Dependency Unit","Critical Care Unit"))

app.aa$sbp_rts <-
  factor(app.aa$sbp_rts, levels=c("4","3","2","1","0","5"),
         labels=c(">89","76-89","50-75","1-49","0","Missing"))

app.aa$gcs_sum <-
  factor(app.aa$gcs_sum, levels=c("3","2","1","5","99"),
         labels=c("Mild: 13-15","Moderate: 9-12","Severe: 3-8","Missing","Pre-intubated"))

app.aa$rr_rts <-
  factor(app.aa$rr_rts, levels=c("3","4","2","1","0","5"),
         labels=c(">29","10-29","6-9","1-5","0","Missing"))

label(app.aa$ofi)      <- "Outcome"
label(app.aa$ISS)      <- "Injury Severity Score"
label(app.aa$Gender)       <- "Sex"
label(app.aa$intub)     <- "Intubation"
label(app.aa$pt_age_yrs)       <- "Age"
label(app.aa$res_survival)       <- "Survival after 30 days"
label(app.aa$host_care_level)       <- "Highest hospital care level"
label(app.aa$intub)       <- "Intubation"
label(app.aa$rr_rts)       <- "Respiratory rate"
label(app.aa$sbp_rts)       <- "Systolic Blood Pressure"
label(app.aa$gcs_sum)       <- "GCS"
label(app.aa$dt_ed_first_ct)       <- "Time to first CT"
label(app.aa$dt_ed_emerg_proc)       <- "Time to intervention"

units(app.aa$dt_ed_emerg_proc)   <- "minutes"
units(app.aa$pt_age_yrs)       <- "Years"
units(app.aa$dt_ed_first_ct)   <- "minutes"
units(app.aa$sbp_rts)       <- "RTS"
units(app.aa$rr_rts)       <- "RTS"

app.outcome_log<-glm(ofi~.,data = app.aa,family = 'binomial')
summary(app.outcome_log)

app.log<-tbl_regression(app.outcome_log,exponentiate = TRUE)

app.log
```


```{r, include=FALSE}

DiagrammeR::grViz("
digraph graph2 {

graph [layout = dot, rankdir = RR]

# node definitions with substituted label text
node [shape = rectangle, width = 4, fillcolor = Biege]
a [label = '@@1']
b [label = '@@2']
c [label = '@@3']
d [label = '@@4']
e [label = '@@5']
f [label = '@@6']
g [label = '@@7']

a -> b -> c {rank = same; b;g;}
c -> d [label='Audit filters identified/ OFI are likely']
c -> e [label='Second opinion needed'] {rank = same; c; e;}
e -> g
d -> f 
e -> d
c -> g [label='No audit filters identified/ OFI are unlikely']

}

graph <- select_nodes(graph)
graph <-
  graph %>%
  nudge_node_positions_ws(
    dx = 0, dy = 10)

[1]: paste0('The occurence of a trauma')
[2]: paste0('Registration in SweTrau')
[3]: paste0('Primary review of audit filters by a nurse')
[4]: paste0('Multidisciplinary morbidity and mortality conference')
[5]: paste0('Secondary review by a colleague')
[6]: paste0('Consensus regarding existance of OFI')
[7]: paste0('Exclusion')


") %>% DiagrammeRsvg::export_svg() %>% charToRaw() %>% rsvg::rsvg_pdf("flowchart_process.pdf")
```

```{r echo=F,results='asis',error=F,warning=F}
sewe<-filter(sew, missing != 0)

rownames(sewe)[rownames(sewe) == "res_survival"] = "Survival after 30 days"
rownames(sewe)[rownames(sewe) == "gcs_sum"] = "GCS"
rownames(sewe)[rownames(sewe) == "rr_rts"] = "Respiratory rate"
rownames(sewe)[rownames(sewe) == "intub"] = "Intubation"
rownames(sewe)[rownames(sewe) == "host_care_level"] = "Highest hospital care level"
rownames(sewe)[rownames(sewe) == "ofi"] = "Outcome"
rownames(sewe)[rownames(sewe) == "pt_age_yrs"] = "Age"
rownames(sewe)[rownames(sewe) == "dt_ed_first_ct"] = "Time to first CT"
rownames(sewe)[rownames(sewe) == "sbp_rts"] = "Systolic blood pressure"
rownames(sewe)[rownames(sewe) == "dt_ed_emerg_proc"] = "Time to intervention"
rownames(sewe)[rownames(sewe) == "Gender"] = "Sex"
```

# Abstract

*Background*: Trauma is one of the leading causes of morbidity and mortality worldwide. Morbidity and mortality review is used to improve the quality of trauma care. During this review specific patient cases are reviewed to identify opportunities for improvement (OFI). The aim of this study was to assess how certain patient level factors are associated with OFI in trauma care.

*Methods*: We used data from the Karolinska University Hospital trauma registry and the trauma care quality database between 2017 and 2021. Our outcome was OFI as defined by the morbidity and mortality review at Karolinska University Hospital. We used bi- and multivariable logistic regression to assess the associations between the following patient level factors and OFI: age, sex, respiratory rate, systolic blood pressure, Glasgow Coma Scale (GCS), Injury Severity Score (ISS), survival at 30 days, highest hospital care level, intubation status and time to CT and intervention. 

*Results*: OFI was identified in 276 (5.94%) out of 4643 patients. The median age for patients with OFI was 49 compared to 42 in patients without OFI. Age, highest hospital care level, ISS, respiratory rate, systolic blood pressure, GCS, survival after 30 days and intubation were statistically significantly associated with OFI. 

*Conclusion*: Several patient level factors were found to be associated with OFI. Future research should focus on identifying reasons why these factors are associated with higher odds of OFI.

\newpage

# Introduction
Trauma is one of the leading causes of mortality and morbidity in all age groups [@David2021;@Ono2021]. There are approximately 4.5 million global deaths each year due to trauma [@James2020], and it is one of the top contributors to disease burden worldwide, measured by disability-adjusted life years [@Murray1996;@Haagsma2015]. Trauma is also resource-intensive as one of the most common reasons for Critical Care Unit admission [@Prin2016].

Patient outcomes are dependent on the quality of their care [@Dogrul2020;@Ghorbani2014;@Kahl2013]. The gold standard method for trauma care quality improvement is morbidity and mortality review, during which specific cases are reviewed to investigate the reasons behind the morbidity or mortality  [@WHO2009]. This review often aims to establish if deaths were preventable and if there are opportunities for improvement (OFI) in the care provided. 

Preventable death rates range between four and 60% across different settings and countries  [@Zafarghandi2003;@Konadu2020; @Ghorbani2018; @Ivatury_2008; @Roy_2017]. However, the rate of OFI in trauma deaths range between 20 and 76% [@Ghorbani2018; @Esposito_2003; @Sanddal_2011] The most common OFI relate to airway management, management of traumatic brain injury, fluid replacement, delays in prehospital transport and delays to surgery [@Zafarghandi2003; @Teixeira2007; @OReilly2013; @Roy_2017]. 

The morbidity and mortality review process is resource-intensive [@Anderson2021]. Only a small number of cases can be reviewed, so selecting the right cases is crucial. Methods such as audit filters are used to identify cases in which OFI are likely. But these methods are fraught with high numbers of false positives and need improvement [@Cryer1996]. The aim of this study was to asses how certain patient level factors are associated with OFI in trauma care.

# Methods

### Study design
We used data from the Karolinska University Hospital trauma registry, part of the Swedish National Trauma Registry (SweTrau) [@Swetrau2020], and the local trauma care quality database. Swetrau includes information of pre-hospital, hospital, and post-hospital care in accordance with the Utstein template [@Utstein2009]. Factors such as demographics, vital signs, time to procedure and time to intervention are registered [@Dick1999]. The trauma care quality database includes all trauma patients treated at the Karolinska University Hospital from the year of 2017. This database includes the results of the morbidity and mortality review including OFI. We linked the trauma registry and trauma care quality database and extracted factors potentially associated with OFI. We used bi- and multivariable logistic regression to determine association with the presence of OFI.

### Setting
In Sweden, the trauma patient is triaged by the emergency medical services personnel at the scene. If one or more of the trauma level one criteria are met then the patient is treated as a priority one [@traumalarmskriterier2017]. All priority one trauma patients in Stockholm  are transported to Karolinska University Hospital to receive care by dedicated trauma teams. These teams consist of a trauma surgeon, an anaesthetist, an orthopaedic surgeon, a radiologist and specialized nurses. Karolinska University Hospital in Solna is a level one trauma center, with direct access to radiology, intervention, operation, intensive care and consultants in all associated specialities [@Social2015;@NKS2020].

Fig.\@ref(fig:flowchart-process) describes the morbidity and mortality review process. Specialised nurses review all trauma patients presenting to Karolinska University Hospital. To facilitate their initial review they apply audit filters to identify cases in which OFI are more likely. These filters are systolic blood pressure under 90, Glasgow Coma Scale (GCS) less than 9 and not intubated, Injury Severity Score (ISS) more than 15 but not admitted to the ICU, time to acute intervention more than 60 minutes, time to computed tomography more than 30 minutes, and death within 30 days after trauma. 

If the specialized nurses decide that there is a potential OFI, the case is selected for inclusion in a morbidity and mortality review conference. During these conferences cases are reviewed by experienced specialists from all the disciplines and professions involved in the trauma team. The presence or absence of OFI is a consensus decision among all participants of the conference and is recorded in the trauma care quality database. A plan to solve the problems identified is also presented by the board.

```{r flowchart-process, fig.cap="Flowchart describing the process of trauma cases from arrival until the inclusion in the trauma care quality database", echo=FALSE, fig.align='center'}
knitr::include_graphics("flowchart_process.pdf")
```

### Participants
The trauma registry includes all patients admitted with trauma team activation, regardless of ISS, as well as patients admitted without trauma team activation but found to have an ISS of more than 9. We included all patients who had been included in the morbidity and mortality review process between 2017 and 2021. We excluded patients who were younger than 15 years. We also excluded patients with missing covariate data.

### Variables

**Study outcome**
The outcome was the presence of OFI, as decided by the morbidity and mortality review board, and defined as a binary variable with the levels "Yes - At least one OFI identified" and "No - No OFI identified". Data on this outcome was extracted from the trauma care quality database. 

**Patient level factors**
We selected factors from the trauma registry to be further examined through discussion, partly based on locally used audit filters, standard epidemiological factors and factors frequently registered in Swetrau. We selected the categorical variables sex, survival after 30 days, highest hospital care level, GCS, respiratory rate, systolic blood pressure and if the patient was intubated. We also selected the continuous variables  age, ISS, time from arrival at the hospital until first CT and time from arrival at the hospital until first intervention.

Systolic blood pressure and respiratory rate are registered as either a continuous or a categorical value according to the Revised Trauma Score, but never both. We decided to convert the continuous values, if registered, into categorical values and include a missing category. GCS was also categorized using the Revised Trauma Score levels. We used pre-hospital values for GCS and respiratory rate for patients who were intubated before arrival at the emergency department because these values are not recorded in the emergency department for these patients. 

The variable highest hospital care level is divided into 5 categories: Emergency Department, General Ward, Surgical Ward, High Dependency Unit and Critical Care Unit. Patients that are in need of higher level of care that can not be provided in the usual General Ward but do not require intensive care are admitted to High Dependency Units such as dedicated trauma wards with more extensive monitoring. Patients with multi-organ failure or who require mechanical ventilation are admitted to Critical Care Units [@Utstein2009].

### Statistical analysis
We use descriptive statistics to present the baseline characteristics. We used bivariable logistic regression to determine unadjusted association, and multivariable logistic regression to determine adjusted associations with the presence of OFI. We present results as odds ratios (OR) with associated 95% confidence interval. We used a significance level of 5%. The programming language R was used for all analyses [@Rstudio2022]. All statistical analysis were first done on synthetic data and later implemented on the data collected from the trauma registry and the trauma care quality database to ensure objectivity. We conducted a complete case analysis.

# Results
The baseline characteristics are presented in Table \@ref(tab:sample-characteristics). Out of `r nrow(combined.datasets)` patients included in the trauma registry between 2017 and 2021, `r nrow(combined.datasets)-nrow(na.kl)` patients were excluded due to missing data and age under 15, leaving a total of `r nrow(na.kl)` patients eligible for the study. The most prevalent reason for exclusion was missing data in the factor `r rownames(sewe[sewe$missing == sewe[1,1],])` with `r sewe[1,1]` patients, `r round(sewe[1,1]/nrow(combined.datasets)*100, digits = 2)`% of patients registered. The number of patients excluded due to missing data in each factor is shown in Table \@ref(tab:missing-data). In the trauma care quality database `r nrow(combined.datasets)-sum(is.na(combined.datasets$ofi))` of the patients were applicable for the study. Once the two databases had been merged and the eligibility criteria applied, a study sample of `r nrow(aa)` patients remained. 

Among the `r nrow(aa)` included patients, `r opo[3,4]` were male. The median age for all patients was `r opo[7,4]`. The survival rate after 30 days among included patients was `r round(sum(aa$res_survival=='Alive')/nrow(aa)*100, digits = 2)`%.

```{r sample-characteristics, fig.align='center', echo = FALSE}
table1_t <- table1(~ pt_age_yrs + Gender + res_survival + host_care_level + intub + ISS + rr_rts + sbp_rts +
         gcs_sum + dt_ed_first_ct | ofi, data=aa, caption = "Sample characteristics")

table1.conv <- t1kable(table1_t) %>%
  kable_styling(latex_options = "HOLD_position", full_width = F, position = "center")

table1.conv
```

```{r missing-data, fig.cap="Note that the total number of missing values is more than the total number of patients as some patients may have missing values in more than one factor", echo = FALSE, fig.align='center'}
missing_table <- knitr::kable(sewe[,1:2], format = "markdown", caption = "<strong> Missing  values in each factor</strong>")

missing_table
```

### Factors associated with opportunity for improvement
OFI were identified in `r sum(aa$ofi == "Opportunity for improvement")` (`r round(sum(aa$ofi == "Opportunity for improvement")/nrow(aa)*100, digits = 2)`%) of the patients. The unadjusted and adjusted associations of selected factors with OFI are presented in Table \@ref(tab:var-adjusted). Age, ISS, GCS and highest hospital care level were significantly associated with OFI in both unadjusted and adjusted analyses. The factors respiratory rate, systolic blood pressure and intubation were significantly associatied with OFI only in the unadjusted analysis. The factor survival after 30 days was significantly associated with OFI only after adjustment for other factors. As seen in Table \@ref(tab:sample-characteristics) the odds of OFI in patients with unregistered GCS was 0.2 compared to patients with mild GCS after the adjustment for other factors, which was statistically significant. 

```{r j, include=FALSE}
tbl_merge_test <-
    tbl_merge(tbls = list(aa %>%
                              select(ofi, pt_age_yrs, Gender, res_survival, rr_rts, sbp_rts, gcs_sum, intub, host_care_level, ISS, dt_ed_first_ct) %>%
                              tbl_uvregression(
                                  method = glm,
                                  y = ofi,
                                  method.args = list(family = binomial),
                                  exponentiate = TRUE,
                                  pvalue_fun = ~style_pvalue(.x, digits = 2),
                                  hide_n = TRUE
                              )%>% bold_p(), tbl_regression(outcome_log,exponentiate = TRUE,pvalue_fun = ~style_pvalue(.x, digits = 2)) %>% bold_p() %>% bold_labels()))


hellp<- tbl_merge_test %>% modify_spanning_header(list (estimate_1 ~ "Unadjusted", ci_1 ~ "Unadjusted", p.value_1 ~ "Unadjusted", estimate_2 ~ "Adjusted", ci_2 ~ "Adjusted", p.value_2 ~ "Adjusted"))

flpp <- hellp %>% as_flex_table()
flpp <- set_table_properties(flpp, width = .8, layout = "autofit")

flpp <- theme_vanilla(flpp)
flpp <- set_caption(flpp, caption = "Adjusted and unadjusted factors")
flpp <- add_footer_lines(flpp, "Multivariable logistic regression analysis of the association between set variables and OFI")
```

```{r var-adjusted, echo=FALSE, message=FALSE, warning=FALSE, fig.align='center'}
flpp
```

As seen in Fig.\@ref(fig:care-level) the odds of OFI differed significantly across highest hospital care level. Patients treated in a high dependency unit had an OR of 15.7 (95% CI 7.8-33.7) unadjusted and 7.67 (95% CI 3.60-16.4) adjusted compared to patients treated in the emergency department. Patients treated in the surgical ward and intensive care unit had ORs of 10.6 (95% CI 5.8-21.1) and 12.1 (95% CI 6.7-24.1) unadjusted versus 6.02 (95% CI 3.12-11.6) and 5.37 (95% CI 2.55-11.3) adjusted, respectively, compared to patients treated in the ED (Table \@ref(tab:var-adjusted)). In patients treated in a high dependency unit OFI was identified in 15.2% of the cases, compared to 1.1% in patients treated in the emergency department.

```{r, include=FALSE}
k.sex <- aa %>% count(ofi, Gender)
k.res <- aa %>% count(ofi, res_survival)
k.intub <- aa %>% count(ofi, intub)
k.host <- aa %>% count(ofi, host_care_level)
k.rr <- aa %>% count(ofi, rr_rts)
k.sbp <- aa %>% count(ofi, sbp_rts)
k.gcs <- aa %>% count(ofi, gcs_sum)

k.sex = ddply(k.sex, .(Gender), transform, percent = n/sum(n) * 100)
k.sex = ddply(k.sex, .(Gender), transform, pos = (cumsum(n) - 0.5 * n))
k.sex$label = paste0(sprintf("%.0f", k.sex$percent))

k.res = ddply(k.res, .(res_survival), transform, percent = n/sum(n) * 100)
k.res = ddply(k.res, .(res_survival), transform, pos = (cumsum(n) - 0.5 * n))
k.res$label = paste0(sprintf("%.0f", k.res$percent))

k.intub = ddply(k.intub, .(intub), transform, percent = n/sum(n) * 100)
k.intub = ddply(k.intub, .(intub), transform, pos = (cumsum(n) - 0.5 * n))
k.intub$label = paste0(sprintf("%.0f", k.intub$percent))

k.host = ddply(k.host, .(host_care_level), transform, percent = n/sum(n) * 100)
k.host = ddply(k.host, .(host_care_level), transform, pos = (cumsum(n) - 0.5 * n))
k.host$label = paste0(sprintf("%.0f", k.host$percent))

k.rr = ddply(k.rr, .(rr_rts), transform, percent = n/sum(n) * 100)
k.rr = ddply(k.rr, .(rr_rts), transform, pos = (cumsum(n) - 0.5 * n))
k.rr$label = paste0(sprintf("%.0f", k.rr$percent))

k.sbp = ddply(k.sbp, .(sbp_rts), transform, percent = n/sum(n) * 100)
k.sbp = ddply(k.sbp, .(sbp_rts), transform, pos = (cumsum(n) - 0.5 * n))
k.sbp$label = paste0(sprintf("%.0f", k.sbp$percent))

k.gcs = ddply(k.gcs, .(gcs_sum), transform, percent = n/sum(n) * 100)
k.gcs = ddply(k.gcs, .(gcs_sum), transform, pos = (cumsum(n) - 0.5 * n))
k.gcs$label = paste0(sprintf("%.0f", k.gcs$percent))

opportunity_sex <- ggplot(k.sex, aes(x = Gender, y = percent, fill = ofi)) +
    geom_bar(position = position_stack(), stat = "identity", width = .7) +
    geom_text(aes(label = label), position = position_stack(vjust = 0.5), size = 4) + labs(y = "Percent (%)", x = "Sex") + guides(fill=guide_legend(title="OFI")) + theme(axis.text.x = element_text(angle = 45, vjust = 0.2, hjust=0.3))

opportunity_survival <- ggplot(k.res, aes(x = res_survival, y = percent, fill = ofi)) +
    geom_bar(position = position_stack(), stat = "identity", width = .7) +
    geom_text(aes(label = label), position = position_stack(vjust = 0.5), size = 4) + labs(y = "Percent (%)", x = "Survival (30 days)") + guides(fill=guide_legend(title="OFI")) + rremove("ylab") + theme(axis.text.x = element_text(angle = 45, vjust = 0.2, hjust=0.3))

opportunity_intub <- ggplot(k.intub, aes(x = intub, y = percent, fill = ofi)) +
    geom_bar(position = position_stack(), stat = "identity", width = .7) +
    geom_text(aes(label = label), position = position_stack(vjust = 0.5), size = 3) + labs(y = "Percent (%)", x = "Intubation") + rremove("ylab") + theme(axis.text.x = element_text(angle = 45, vjust = 0.2, hjust=0.3))

opportunity_rr <- ggplot(k.rr, aes(x = rr_rts, y = percent, fill = ofi)) +
    geom_bar(position = position_stack(), stat = "identity", width = .7) +
    geom_text(aes(label = label), position = position_stack(vjust = 0.5), size = 2) + labs(y = "Percent (%)", x = "Respiratory rate") + guides(fill=guide_legend(title="OFI")) + theme(axis.text.x = element_text(angle = 45, vjust = 0.2, hjust=0.3))

opportunity_sbp <- ggplot(k.sbp, aes(x = sbp_rts, y = percent, fill = ofi)) +
    geom_bar(position = position_stack(), stat = "identity", width = .7) +
    geom_text(aes(label = label), position = position_stack(vjust = 0.5), size = 2) + labs(y = "Percent (%)", x = "Systolic blood pressure") + guides(fill=guide_legend(title="OFI")) + rremove("ylab") + theme(axis.text.x = element_text(angle = 45, vjust = 0.2, hjust=0.3))

opportunity_gcs <- ggplot(k.gcs, aes(x = gcs_sum, y = percent, fill = ofi)) +
    geom_bar(position = position_stack(), stat = "identity", width = .7) +
    geom_text(aes(label = label), position = position_stack(vjust = 0.5), size = 2.5) + labs(y = "Percent (%)", x = "Glasgow coma scale") + guides(fill=guide_legend(title="OFI")) + rremove("ylab") + theme(axis.text.x = element_text(angle = 45, vjust = 0.2, hjust=0.3))

opportunity_host <- ggplot(k.host, aes(x = host_care_level, y = percent, fill = ofi)) +
    geom_bar(position = position_stack(), stat = "identity", width = .7) +
    geom_text(aes(label = label), position = position_stack(vjust = 0.5), size = 3) + labs(y = "Percent (%)", x = "Highest hospital care level") + guides(fill=guide_legend(title="OFI")) + theme(axis.text.x = element_text(angle = 45, vjust = 0.2, hjust=0.3))

pp<- ggarrange(opportunity_sex, opportunity_survival ,opportunity_intub, opportunity_rr, opportunity_sbp, opportunity_gcs,
          labels = c("A", "B", "C", "D","E","F"),
          ncol = 3, nrow = 2, common.legend = TRUE, legend = "bottom")

opportunity_host
pp

```

```{r, include=FALSE}
e.host<-k.host[!(k.host$ofi=="No opportunity for improvement"),]
op.host <- ggplot(e.host, aes(x = host_care_level, y = percent, fill = ofi)) +
    geom_bar(position = "dodge", stat = "identity", width = .7) +
    geom_text(aes(label = label), position = position_dodge(width = 1),
    vjust = -0.5, size = 3.5) + labs(y = "%", x = "Highest hospital care level") + guides(fill=guide_legend(title="OFI")) + theme(axis.text.x = element_text(angle = 45, vjust = 0.2, hjust=0.3, colour = "black"), legend.title=element_blank(), legend.position="none") + ylim(0, 20)
op.host

e.sex<-k.sex[!(k.sex$ofi=="No opportunity for improvement"),]
op.sex <- ggplot(e.sex, aes(x = Gender, y = percent, fill = ofi)) +
    geom_bar(position = position_stack(), stat = "identity", width = .7) +
    geom_text(aes(label = label), position = position_dodge(width = 1),
    vjust = -0.5, size = 3.5) + labs(y = "%", x = "Sex") + guides(fill=guide_legend(title="OFI")) + theme(axis.text.x = element_text(angle = 45, vjust = 0.2, hjust=0.3, size=8, colour = "black")) + ylim(0, 20)
op.sex

e.res<-k.res[!(k.res$ofi=="No opportunity for improvement"),]
op.res <- ggplot(e.res, aes(x = res_survival, y = percent, fill = ofi)) +
    geom_bar(position = position_stack(), stat = "identity", width = .7) +
    geom_text(aes(label = label), position = position_dodge(width = 1),
    vjust = -0.5, size = 3.5) + labs(y = "%", x = "Survival after 30 days") + guides(fill=guide_legend(title="OFI")) + theme(axis.text.x = element_text(angle = 45, vjust = 0.2, hjust=0.3, size=10, colour = "black")) + ylim(0, 20)
op.res

e.intub<-k.intub[!(k.intub$ofi=="No opportunity for improvement"),]
op.intub <- ggplot(e.intub, aes(x = intub, y = percent, fill = ofi)) +
    geom_bar(position = position_stack(), stat = "identity", width = .7) +
    geom_text(aes(label = label), position = position_dodge(width = 1),
    vjust = -0.5, size = 3.5) + labs(y = "%", x = "Intubation") + guides(fill=guide_legend(title="OFI")) + theme(axis.text.x = element_text(angle = 45, vjust = 0.2, hjust=0.3, size=6, colour = "black")) + ylim(0, 20)
op.intub

e.rr<-k.rr[!(k.rr$ofi=="No opportunity for improvement"),]
op.rr <- ggplot(e.rr, aes(x = rr_rts, y = percent, fill = ofi)) +
    geom_bar(position = position_stack(), stat = "identity", width = .7) +
    geom_text(aes(label = label), position = position_dodge(width = 1),
    vjust = -0.5, size = 3.5) + labs(y = "%", x = "Respiratory rate") + guides(fill=guide_legend(title="OFI")) + theme(axis.text.x = element_text(angle = 45, vjust = 0.2, hjust=0.3, size=10, colour = "black")) + ylim(0, 20)
op.rr

e.sbp<-k.sbp[!(k.sbp$ofi=="No opportunity for improvement"),]
e.sbp[nrow(e.sbp) + 1,] <- c("Opportunity for improvement", "1-49", 0,0,0,0)
e.sbp[nrow(e.sbp) + 1,] <- c("Opportunity for improvement", "0", 0,0,0,0)
e.sbp[nrow(e.sbp) + 1,] <- c("Opportunity for improvement", "Missing", 0,0,0,0)
e.sbp$percent<-as.numeric(e.sbp$percent)
op.sbp <- ggplot(e.sbp, aes(x = sbp_rts, y = percent, fill = ofi)) +
    geom_bar(position = position_stack(), stat = "identity", width = .7) +
    geom_text(aes(label = label), position = position_dodge(width = 1),
    vjust = -0.5, size = 3.5) + labs(y = "%", x = "Systolic blood pressure") + guides(fill=guide_legend(title="OFI")) + theme(axis.text.x = element_text(angle = 45, vjust = 0.2, hjust=0.3, size=10, colour = "black")) + ylim(0, 20)
op.sbp

e.gcs<-k.gcs[!(k.gcs$ofi=="No opportunity for improvement"),]
op.gcs <- ggplot(e.gcs, aes(x = gcs_sum, y = percent, fill = ofi)) +
    geom_bar(position = position_stack(), stat = "identity", width = .7) +
    geom_text(aes(label = label), position = position_dodge(width = 1),
    vjust = -0.5, size = 3.5) + labs(y = "%", x = "Glasgow Coma Scale") + guides(fill=guide_legend(title="OFI")) + theme(axis.text.x = element_text(angle = 45, vjust = 0.2, hjust=0.3, size=8, colour = "black")) + ylim(0, 20)
op.gcs


new.bar <- ggarrange(op.sex, op.res ,op.intub, op.rr, op.sbp, op.gcs,
          labels = c("A", "B", "C", "D","E","F"),
          ncol = 3, nrow = 2, common.legend = TRUE, legend = "none")
new.bar
```

```{r care-level, fig.cap="Opportunity for improvement presented in the factor Highest hospital care level.", echo=FALSE}

op.host
```

Fig.\@ref(fig:restbarchart) displays the proportion of OFI in the remaining categorical factors. OFI was found in 5.8% of the patients with a systolic blood pressure higher than 89, and 17.6% in patients with a systolic blood pressure between 50-75. No patient with a systolic blood pressure lower than 50 had any OFI registered. Patients intubated in the hospital also had a higher percentage of OFI compared to patients not intubated or intubated before arrival at the hospital. 

```{r restbarchart, fig.cap= "Opportunity for improvement presented in the remaining factors. Intub = Intubated, Pre-intub = Patient intubated before arrival at the emergency department", echo=FALSE}

new.bar
```


```{r, include=FALSE}
ppp <- ggplot(data = aa, aes(x=ofi, y=ISS)) + 
             geom_boxplot(aes(fill=ofi))+ labs(x = "OFI") + theme(axis.text.x=element_blank(), axis.title.x = element_blank(),legend.title= element_blank())
ppp

qqq <- ggplot(data = aa, aes(x=ofi, y=pt_age_yrs)) + 
             geom_boxplot(aes(fill=ofi)) + labs(y = "Age (Years)", x = "OFI") + theme(axis.text.x=element_blank(), axis.title.x = element_blank(),legend.title= element_blank())
qqq

ccc <- ggplot(data = aa, aes(x=ofi, y=dt_ed_first_ct)) + 
             geom_boxplot(aes(fill=ofi)) + scale_y_log10() + labs(y = "Time to first CT (Sec)", x = "OFI") + theme(axis.text.x=element_blank(), axis.title.x = element_blank(),legend.title= element_blank())
ccc


new.cont <- ggarrange(ppp,qqq,ccc,
          labels = c("A", "B", "C"),
          ncol = 3, nrow = 1, common.legend = TRUE, legend = "bottom")

new.cont
```

Fig.\@ref(fig:boxchart) compares ISS, age and time to first CT between patients with and without OFI. The median age for patients with OFI is 49, which is 7 years higher than the median for the group of patients without OFI. The median ISS is also 12 units higher in the OFI-group, 17 compared to 5 in no OFI. Age was also statistically significant in both analyses. The factor time to first CT was not significantly different in patients with OFI compared to those without.

```{r boxchart, fig.cap= "Box plot displaying the distrubtion of patients with OFI and those without in the continuous variables. C displays the distrubtion in regard to time to first CT in logarithmic scale", echo=FALSE}
new.cont
```


\newpage

# Discussion

Although the regional rate of OFI evidently falls in the lower end of the spectrum, there is room for local and global improvement. This study has recognized factors that could decrease those rates further. Patient level factors found to be associated with OFI were age, highest hospital care level, ISS, GCS, respiratory rate, systolic blood pressure, survival after 30 days and intubation. Despite previous studies identifying disparities in the outcome for trauma patients dependent on sex [@Marcolini2019;@Duong2020], this study did not find sex to be associated with the rate of OFI. Neither was the factor time to first CT.

The factor most strongly associated with OFI was highest hospital care level with an odds ratio of 15.7 and 12.1 in high dependency units and critical care units, respectively. This means that patients treated in the high dependency units and critical care units are much more likely to be exposed to preventable errors than those treated in the emergency department. A previous study in the US has shown that more than half of the preventable and probably preventable deaths occur in critical care units [@Teixeira2007]. This could be explained by the complexity, severeness and amount of intervention needed for cases treated in these units. According to the same study the most prevalent OFI were related to airway management and perioperative care and those patients are usually found in critical care units [@Teixeira2009]. The cases in high dependency units are also complex, although these wards lack the access to the same amount of resources and personnel as critical care units. This could explain why the odds ratio of OFI is even higher in high dependency units compared to critical care units. Patients with emergency department as the highest hospital care level are usually less injured and therefore need less intervention which in turn leads to lower odds of OFI.

High odds of OFI was also found in patients alive 30 days after trauma, in the adjusted analysis. The reason could be that most patients that die within 30 days usually die in the first days, with a peak of trauma deaths only 1 hour after trauma [@Hwang2020]. Shorter hospital stay decrease the possibility of being exposed to OFI.

OFI was identified in 6.8% of all trauma deaths at Karolinska University Hospital. A study published 2018 from the same hospital identified at least one preventable error in 21% of all trauma deaths, although only 4% of all trauma deaths were found to be preventable [@Ghorbani2018]. A possible explanation for the lower number of OFI in those who died in our study compared to the previous study could be due to the adaption of new treatment strategies and the implementation of quality improvement programs. However the criteria used to determine the presence of OFI during that time was different, and therefore the results do not necessarily mean a decrease in OFI.

Other factors associated with OFI are age and ISS. The median age is seven years higher in patients with OFI. A systematic review published 2017 identified many studies where lower healthcare quality for elders was potentially justified by the lower chance of survival [@Salway2017]. The argument that focusing more resources on younger patients could lead to a lower mean value of disability-adjusted life years could be made. However, the higher frequency of comorbidities among the elderly should be considered. Higher mortality in elder patients even though there were no major differences in ISS compared to younger patients is also found in previous studies [@MacDonald_2020; @Earl_Royal_2016]. The comorbidity, fragility and differences in clinical presentation of the elderly could be an explanation for higher odds of OFI in those patients.

The median ISS was 17 in the group with OFI compared to five in cases with no OFI, meaning that OFI are more likely to be identified in patients with more complex trauma. Similar findings were found in two studies performed in Germany. These studies showed higher numbers of preventable errors in patients with ISS > 15 compared to the whole population. In Cologne when analyzing preventable and potentially preventable deaths in patients with ISS > 15 they estimated it to be 20.2% of all trauma deaths [@Schoeneberg2016]. When calculating the same numbers in Berlin for all patients, regardless of ISS, it was estimated to be 15.1% of all trauma deaths [@Kleber2013]. This could be due to the complexity of these severe cases, the lack of training or protocols in the care of patients with severe injuries. Another explanation could be due to lack of resources needed for the treatment of severe injuries.

When analyzing the vital signs included, some associations with OFI was found. The model failed to estimate an association between three groups in systolic blood pressure, two groups in respiratory rate and OFI, respectively. This could be due to the lack of patients in these groups. Statistical significance was found in systolic blood pressure 50-75 and respiratory rate >29, both unadjusted. A study performed in Iran showed similar findings when comparing preventable deaths between patients with a respiratory rate <20 and 20 or higher. It was found that deaths in patients with 20 or higher in respiratory rate were more likely to be preventable [@Davoodabadi2021]. Patients intubated after arriving to the hospital had also increased odds of OFI compared to patients not intubated. Higher odds of OFI in these cases could be explained by the severeness of these traumas. This would also explain why these factors are not statistically significant after the adjustment for other variables.

The primary limitation was although all trauma 1 patients were reviewed by specialized nurses, the selection for review by the morbidity and mortality conference relied mostly on audit filters. The audit filters are as mentioned earlier not yet proven to be effective, meaning that there is a possibility some cases with OFI were not selected for review by the conference and therefore registered as a case with no OFI. Furthermore this study was also a single centre study, and the results illustrates the situation in Stockholm. Since the trauma care differs between hospital, it is difficult to implement these results globally without further research.

In conclusion more severe trauma that lead to abnormal vital signs and higher hospital care level were found to be significantly associated with OFI after the adjustment for other factors. Future research should focus on identifying reasons why the care of patients with severe trauma is more susceptible for OFI and how this can be alleviated.

# Appendix

Table of sample characteristics, if Time to procedure was included (Table \@ref(tab:sample-character))

```{r sample-character, fig.align='center', echo = FALSE}
table2_t <- table1(~ Gender + pt_age_yrs + res_survival + host_care_level + intub + ISS + rr_rts + sbp_rts + gcs_sum + dt_ed_first_ct + dt_ed_emerg_proc | ofi, data=app.aa, caption = "Sample characteristics, if Time to procedure was included")

table2.conv <- t1kable(table2_t) %>%
  kable_styling(latex_options = "HOLD_position", full_width = F, position = "center")

table2.conv
```

Table with unadjusted and adjusted factors with odds ratio, confidence interval and p-value respectively (Table \@ref(tab:var-time))

```{r, include=FALSE}

tbl_merge_test3 <-
    tbl_merge(tbls = list(app.aa %>%
                              select(ofi, Gender, pt_age_yrs, res_survival, rr_rts, sbp_rts, gcs_sum, intub, host_care_level, ISS, dt_ed_first_ct, dt_ed_emerg_proc) %>%
                              tbl_uvregression(
                                  method = glm,
                                  y = ofi,
                                  method.args = list(family = binomial),
                                  exponentiate = TRUE,
                                  pvalue_fun = ~style_pvalue(.x, digits = 2),
                                  hide_n = TRUE
                              )%>% bold_p(), tbl_regression(app.outcome_log,exponentiate = TRUE,pvalue_fun = ~style_pvalue(.x, digits = 2)) %>% bold_p() %>% bold_labels()))


app.hellp<- tbl_merge_test3 %>% modify_spanning_header(list (estimate_1 ~ "Unadjusted", ci_1 ~ "Unadjusted", p.value_1 ~ "Unadjusted", estimate_2 ~ "Adjusted", ci_2 ~ "Adjusted", p.value_2 ~ "Adjusted"))



app.flpp <- app.hellp %>% as_flex_table()
app.flpp <- set_table_properties(app.flpp, width = .8, layout = "autofit")

app.flpp <- theme_vanilla(app.flpp)
app.flpp <- set_caption(app.flpp, caption = "Adjusted and unadjusted factors")
app.flpp <- add_footer_lines(app.flpp, "Unadjusted and adjusted factors with odds ratio, confidence interval and p-values")

app.flpp
```

```{r var-time, echo=FALSE, message=FALSE, warning=FALSE, fig.align='center'}
app.flpp
```

# References

